"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),u=Symbol("ModalStateToken"),M=Symbol("ModalIdToken"),f=()=>e.inject(u,{}),C=()=>e.inject(M,""),_=e.defineComponent({__name:"CreateModal",props:{modalId:{type:String}},setup(d){const r=d,{action:n}=f();return e.provide(M,r.modalId),e.onUnmounted(()=>{r.modalId&&n?.remove(r.modalId)}),(l,o)=>e.renderSlot(l.$slots,"default")}});function I(){let d=0;const r=()=>`__modal_${d++}`,n=Symbol("ModalId"),l={},o=e.reactive(l),a={},i={show:(t,s)=>{s&&(o[t].args={...o[t].args,...s}),o[t].visible=!0},hide:t=>{o[t].visible=!1},remove:t=>{delete o[t],delete a[t]},getModalId:t=>(t[n]||(t[n]=r()),t[n]),register:(t,s,c)=>{o[t]?o[t].args=c:o[t]={comp:s,visible:!1,args:c}}};return e.provide(u,{store:o,action:i,modalPromise:a}),{modalList:e.computed(()=>Object.keys(o).filter(s=>!!o[s]).filter(s=>o[s]).map(s=>({id:s,...o[s],comp:e.toRaw(o[s].comp)})))}}function b(){const{modalList:d}=I();return{ModalContent:e.defineComponent({name:"ModalContent",render(){return d.value.map(n=>e.h(_,{modalId:n.id},()=>e.h(n.comp,n.args)))}})}}function P(d,r){const l=e.getCurrentInstance().provides[u];let o=f();l&&(o=l);const a=o.action?.getModalId(d),i=e.ref(!0),m=o.store?.[a];return{show:c=>{if((i.value||!m)&&(o.action?.register(a,d,r),i.value=!1),!o.modalPromise[a]){let p,v;const h=new Promise((g,k)=>{p=g,v=k});o.modalPromise[a]={promise:h,reject:v,resolve:p}}return o.action?.show(a,c),o.modalPromise[a].promise},hide:()=>o.action?.hide(a)}}function S(){const{store:d,action:r,modalPromise:n}=f(),l=C(),o=d[l],a=c=>r?.show(l,c),i=()=>r?.hide(l),m=()=>r?.remove(l),t=c=>n[l].resolve(c),s=c=>n[l].reject(c);return{show:a,hide:i,visible:e.toRef(o,"visible"),args:e.toRef(o,"args"),remove:m,resolve:t,reject:s}}const w=e.defineComponent({__name:"ModalProvider",setup(d){const{modalList:r}=I();return(n,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.renderSlot(n.$slots,"default"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),o=>(e.openBlock(),e.createBlock(_,{key:o.id,"modal-id":o.id},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.comp),e.normalizeProps(e.guardReactiveProps(o.args)),null,16))]),_:2},1032,["modal-id"]))),128))],64))}});exports.ModalProvider=w;exports.createdModalContext=b;exports.useModal=P;exports.useModalRef=S;
